services:
  plex-playlist-importer:
    build: .
    container_name: plex-playlist-importer
    restart: unless-stopped
    ports:
      - "8765:8000"
    volumes:
      # Config persistence
      - ./config:/config
      # Debug log (host .cursor for agent log file)
      - ../.cursor:/cursor-debug
      # Mount the full music root so that Artists/, playlists, etc. are under /music
      # Example: on server if music is at /mnt/tower/mediadata/media/music then:
      #   - /mnt/tower/mediadata/media/music:/music:ro
      # Playlists like .../music/Artists/Armin van Buuren/Armin van Buuren.m3u8
      # will appear as /music/Artists/Armin van Buuren/Armin van Buuren.m3u8 in container
      - /mnt/data/media/music:/music:ro
    environment:
      - TZ=Europe/Moscow
      - SPOTIFY_SCRAPER_URL=http://host.docker.internal:3020
      # SLSKD Integration (set your API key)
      - SLSKD_API_KEY=${SLSKD_API_KEY:-}
      - SLSKD_URL=http://host.docker.internal:5030
    extra_hosts:
      - "host.docker.internal:host-gateway"
    # If Plex is in Docker, they need to be on the same network
    # networks:
    #   - plex_network

# Uncomment if Plex is in Docker
# networks:
#   plex_network:
#     external: true
